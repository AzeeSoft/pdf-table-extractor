<!DOCTYPE html>
<html>
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <meta charset="UTF-8">
  <title>PDF tables extractor</title>
</head>
<body>

<h1>PDF tables extractor</h1>
<p>Sample: <a href="samples/pta_10229_131308_94274.pdf">samples/pta_10229_131308_94274.pdf</a></p>
<h2>JSON Result</h2>
<textarea id="json-result" style="width: 100%; height: 200px"></textarea>
<h2>HTML Result:</h2>
<div id="html-result">
</div>

<script src="//mozilla.github.io/pdf.js/build/pdf.js"></script>
<script src="pdf-table-extractor.js"></script>
<script id="script">
  //
  // If absolute URL from the remote server is provided, configure the CORS
  // header on that server.
  //
  var url = 'samples/pta_10229_131308_94274.pdf';

  PDFJS.workerSrc = '//mozilla.github.io/pdf.js/build/pdf.worker.js';

  PDFJS.getDocument(url).then(pdf_table_extractor).then(function(result){
    // JSON output
    document.getElementById('json-result').innerText = JSON.stringify(result);
    // HTML output
    while (page_tables = result.pageTables.shift()) {
        $('#html-result').append($('<h3></h3>').text('Page ' + page_tables.page));
	table_dom = $('<table></table>').attr('border', 1);
	var tables = page_tables.tables;
	var merge_alias = page_tables.merge_alias;
	var merges = page_tables.merges;

        for (var r = 0; r < tables.length; r ++) {
	    tr_dom = $('<tr></tr>');
	    for (var c = 0; c < tables[r].length; c ++) {
		r_c = [r, c].join('-');
                if (merge_alias[r_c]) {
		    continue;
		}

                td_dom = $('<td></td>');
		if (merges[r_c]) {
		    if (merges[r_c].width > 1) {
			td_dom.attr('colspan', merges[r_c].width);
		    }
		    if (merges[r_c].height > 1) {
			td_dom.attr('rowspan', merges[r_c].height);
		    }
		}
		td_dom.text(tables[r][c]);
		tr_dom.append(td_dom);
	    }
	    table_dom.append(tr_dom);
	}
	$('#html-result').append(table_dom);
        
    };
});;
</script>
